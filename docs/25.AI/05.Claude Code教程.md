# Claude Code 命令教程

Claude Code 是一个强大的命令行工具，让开发者能够直接从终端与 Claude AI 进行交互，实现高效的代码开发和问题解决。

## 安装指南

**官方文档：** [https://docs.anthropic.com/zh-CN/docs/claude-code/overview](https://docs.anthropic.com/zh-CN/docs/claude-code/overview)

**智谱AI接入：** [https://docs.bigmodel.cn/cn/guide/develop/claude](https://docs.bigmodel.cn/cn/guide/develop/claude)

也可接入通义前问等模型

## 基础命令

### 项目初始化

```bash
claude /init
```

**作用：** 在当前目录初始化一个新的 Claude Code 项目，创建必要的配置文件和目录结构。

**示例：**
```bash
cd my-project
claude /init
```

这将在项目根目录创建 `.claude` 配置目录，为后续开发做好准备。

### 集成开发环境模式

```bash
claude /ide
```

**作用：** 启动交互式开发环境，提供更丰富的开发体验和持续对话能力。

**示例：**
```bash
claude /ide
# 进入交互模式，可以进行持续的代码讨论和修改
```

## 思考增强功能

### Think 命令

```bash
claude think
```

**作用：** 为 Claude 提供额外的思考时间，帮助处理复杂问题。有两种触发方式：
- `manual` - 手动调用
- `auto` - 上下文窗口满时自动触发

### 思考级别关键词

在提示中添加以下关键词，按复杂度递增排列：

| 关键词 | Token 消耗 | 适用场景 |
|--------|-----------|----------|
| `think` | 最低 | 简单问题思考 |
| `think hard` | 中等 | 中等复杂度问题 |
| `think harder` | 较高 | 复杂逻辑问题 |
| `ultrathink` | 最高 | 极其复杂的问题 |

**示例：**
```bash
claude "ultrathink 设计一个分布式缓存系统的架构"
```

## 运行模式

### 非交互模式

```bash
claude -p "你的问题"
```

**作用：** 直接提问并获取答案，不进入交互式对话模式。

**示例：**
```bash
claude -p "解释 JavaScript 的事件循环机制"
```

## MCP 连接器管理

MCP (Model Context Protocol) 允许 Claude 连接外部工具和服务。

### 添加 MCP 连接器

```bash
# 添加用户级别的连接器
claude mcp add context7 --scope user -- npx -y @upstash/context7-mcp --api-key your-api-key

# 添加 HTTP 传输连接器
claude mcp add --transport http chrome-mcp http://127.0.0.1:12306/mcp
```

### 移除 MCP 连接器

```bash
claude mcp remove context7
```

**示例场景：**
- 连接数据库服务
- 集成浏览器控制
- 接入第三方 API

## 权限管理

### 查看权限

```bash
claude permissions
```

### 跳过权限检查（谨慎使用）

```bash
claude --dangerously-skip-permissions
```

**注意：** 此选项会跳过所有安全检查，仅在完全信任的环境中使用。

## 自定义功能

### 自定义命令

在项目的 `.claude/commands` 目录下创建自定义命令脚本。

**示例：**
```bash
# 创建自定义命令
mkdir -p .claude/commands
echo '#!/bin/bash\necho "执行项目构建..."' > .claude/commands/build
chmod +x .claude/commands/build

# 使用自定义命令
claude /build
```

### Hooks（钩子函数）

在 `.claude/hooks` 目录下设置在特定事件后执行的脚本。

**示例：**
```bash
# 创建后处理钩子
mkdir -p .claude/hooks
echo '#!/bin/bash\necho "命令执行完成，运行测试..."' > .claude/hooks/post-command
chmod +x .claude/hooks/post-command
```

## 高级功能

### Sub Agent

Claude Code 支持创建子代理来处理特定任务，实现任务分工和并行处理。

### 历史对话管理

```bash
# 查看对话历史
claude history

# 搜索历史记录
claude history search "关键词"
```

## 最佳实践

### 1. 项目管理
- 每个新项目都先运行 `claude /init`
- 合理组织 `.claude` 目录结构
- 使用版本控制管理配置文件

### 2. 思考功能使用
- 简单问题使用 `think`
- 架构设计类问题使用 `think harder` 或 `ultrathink`
- 根据问题复杂度选择合适级别

### 3. 权限安全
- 避免不必要使用 `--dangerously-skip-permissions`
- 定期检查和更新权限设置
- 在生产环境中特别注意权限管理

### 4. 自定义优化
- 将常用操作封装为自定义命令
- 使用 hooks 实现自动化工作流
- 合理配置 MCP 连接器

### 5. 工作流程
```bash
# 标准工作流程示例
claude /init                    # 初始化项目
claude /ide                     # 启动开发环境
claude "think hard 分析这个bug"  # 深度思考问题
claude mcp add database-tool     # 添加必要工具
```

## 故障排除

### 常见问题及解决方案

**权限被拒绝**
```bash
# 检查文件权限
ls -la .claude/
# 或使用权限选项
claude --help permissions
```

**MCP 连接失败**
```bash
# 检查服务状态
curl -f http://127.0.0.1:12306/mcp
# 重新添加连接器
claude mcp remove problematic-connector
claude mcp add problematic-connector --transport http http://127.0.0.1:12306/mcp
```

**自定义命令无法执行**
```bash
# 检查脚本权限
chmod +x .claude/commands/your-command
# 检查脚本语法
bash -n .claude/commands/your-command
```

### 获取帮助

```bash
# 查看全局帮助
claude --help

# 查看特定命令帮助
claude mcp --help
claude permissions --help

# 查看版本信息
claude --version
```

## 高效使用技巧

1. **组合使用命令**：将多个命令组合使用以实现复杂工作流
2. **利用历史记录**：通过历史功能快速回顾和重用之前的解决方案
3. **定制开发环境**：根据项目需求配置专属的 MCP 连接器和自定义命令
4. **合理使用思考功能**：在复杂问题上投入更多思考 token，在简单问题上保持效率

通过掌握这些命令和最佳实践，你可以充分发挥 Claude Code 的强大功能，显著提升开发效率和代码质量。