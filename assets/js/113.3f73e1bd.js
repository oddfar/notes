(window.webpackJsonp=window.webpackJsonp||[]).push([[113],{472:function(s,t,a){"use strict";a.r(t);var n=a(15),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"mongodb安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mongodb安装"}},[s._v("#")]),s._v(" MongoDB安装")]),s._v(" "),t("h3",{attrs:{id:"参考文档"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考文档"}},[s._v("#")]),s._v(" 参考文档")]),s._v(" "),t("p",[s._v("官网下载："),t("a",{attrs:{href:"https://www.mongodb.com/try/download/community",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.mongodb.com/try/download/community"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("官网文档："),t("a",{attrs:{href:"https://docs.mongodb.com/v3.6/administration/install-community/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://docs.mongodb.com/v3.6/administration/install-community/"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("菜鸟教程："),t("a",{attrs:{href:"https://www.runoob.com/mongodb/mongodb-window-install.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.runoob.com/mongodb/mongodb-window-install.html"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"以docker为例安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#以docker为例安装"}},[s._v("#")]),s._v(" 以Docker为例安装")]),s._v(" "),t("p",[s._v("1、拉取镜像")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mongo:latest\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("注意：有的服务器不支持新版本，会导致Docker启动失败，具体原因看报错内容")]),s._v(" "),t("p",[s._v("可选择其他版本（我使用的服务器5.0及以上版本都不可使）")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mongo:4.4.8\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("2、创建和启动容器")]),s._v(" "),t("p",[s._v("以 4.4.8 版本为例 "),t("Badge",{attrs:{text:"建议加上密码，原因看下方"}})],1),s._v(" "),t("code-group",[t("code-block",{attrs:{title:"不带密码启动",active:""}},[t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--restart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" mymongo "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("27017")]),s._v(":27017 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /data/docker/mongodb:/data/db "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  mongo:4.4.8\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])]),s._v(" "),t("code-block",{attrs:{title:"带密码启动"}},[t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--restart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" mymongo "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("27017")]),s._v(":27017  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MONGO_INITDB_ROOT_USERNAME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mymongoadmin "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MONGO_INITDB_ROOT_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root123456 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /data/docker/mongodb:/data/db "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  mongo:4.4.8\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])])])],1),s._v(" "),t("p",[s._v("使用账户密码启动的，需要给数据库创建用户权限：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("db.createUser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        user:"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"admin"')]),s._v(",\n        pwd:"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root123456"')]),s._v(",\n        roles:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("role:"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dbOwner"')]),s._v(",db:"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yygh_hosp"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("之后sping中MongoDB地址改成：")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("spring.data.mongodb.uri")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("mongodb://admin:root123456@IP:端口/yygh_hosp")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("角色权限说明(role)：")]),s._v(" "),t("p",[s._v("Built-In Roles（内置角色）：")]),s._v(" "),t("ol",[t("li",[s._v("数据库用户角色：read、readWrite;")]),s._v(" "),t("li",[s._v("数据库管理角色：dbAdmin、dbOwner、userAdmin；")]),s._v(" "),t("li",[s._v("集群管理角色：clusterAdmin、clusterManager、clusterMonitor、hostManager；")]),s._v(" "),t("li",[s._v("备份恢复角色：backup、restore；")]),s._v(" "),t("li",[s._v("所有数据库角色：readAnyDatabase、readWriteAnyDatabase、userAdminAnyDatabase、dbAdminAnyDatabase")]),s._v(" "),t("li",[s._v("超级用户角色：root")])]),s._v(" "),t("blockquote",[t("p",[s._v("这里还有几个角色间接或直接提供了系统超级用户的访问")]),s._v(" "),t("p",[s._v("（dbOwner 、userAdmin、userAdminAnyDatabase）")])]),s._v(" "),t("Badge",{attrs:{text:"带密码原因：",type:"error",vertical:"middle"}}),s._v(" "),t("p",[s._v("之前学习 "),t("a",{attrs:{href:"https://www.bilibili.com/video/BV1V5411K7rT?p=163",target:"_blank",rel:"noopener noreferrer"}},[s._v("尚硅谷-尚医通项目"),t("OutboundLink")],1),s._v(" 用到了MongoDB")]),s._v(" "),t("p",[s._v("我安装到了服务器上，没换端口地址且没设密码")]),s._v(" "),t("p",[s._v("后来某一天，数据库让淦了，所有数据都没了，只剩下个勒索数据：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://testingcf.jsdelivr.net/gh/oddfar/static/img/MongoDB/image-20210911115120977.png",alt:"image-20210911115120977"}})]),s._v(" "),t("p",[s._v("翻译后：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://testingcf.jsdelivr.net/gh/oddfar/static/img/MongoDB/image-20210911115316142.png",alt:"image-20210911115316142"}})]),s._v(" "),t("p",[s._v("还好只是学习的测试数据，不然就完犊子了")]),s._v(" "),t("p",[s._v("百度了一下参考了 "),t("a",{attrs:{href:"https://blog.csdn.net/u013513053/article/details/105785980/",target:"_blank",rel:"noopener noreferrer"}},[s._v("mongoDB 数据莫名其妙的没了"),t("OutboundLink")],1),s._v(" 这篇文章，才知道数据库是被黑了")]),s._v(" "),t("h2",{attrs:{id:"连接和建库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#连接和建库"}},[s._v("#")]),s._v(" 连接和建库")]),s._v(" "),t("p",[s._v("默认保留的数据库")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("admin")]),s._v(": 从权限角度考虑, 这是 "),t("code",[s._v("root")]),s._v(" 数据库, 如果将一个用户添加到这个数据库, 这个用户自动继承所有数据库的权限, 一些特定的服务器端命令也只能从这个数据库运行, 比如列出所有的数据库或者关闭服务器")]),s._v(" "),t("li",[t("strong",[s._v("local")]),s._v(": 数据永远不会被复制, 可以用来存储限于本地的单台服务器的集合 (部署集群, 分片等)")]),s._v(" "),t("li",[t("strong",[s._v("config")]),s._v(": Mongo 用于分片设置时, "),t("code",[s._v("config")]),s._v(" 数据库在内部使用, 用来保存分片的相关信息")])]),s._v(" "),t("p",[s._v("进入容器")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" mymongo /bin/bash \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("连接mongo")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("mongo "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" mymongoadmin "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" root123456\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("基本操作：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看所有数据库")]),s._v("\nshow dbs\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#使用数据库，没有这个数据则自动创建")]),s._v("\nuse testdb\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("当 "),t("code",[s._v("use testdb")]),s._v(" 的时候. "),t("code",[s._v("testdb")]),s._v(" 其实存放在内存之中,")]),s._v(" "),t("p",[s._v("当 "),t("code",[s._v("testdb")]),s._v(" 中存在一个 document 之后, mongo 才会将这个数据库持久化到硬盘之中.")]),s._v(" "),t("h2",{attrs:{id:"文档基本-crud"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文档基本-crud"}},[s._v("#")]),s._v(" 文档基本 CRUD")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("官方文档")]),s._v(" "),t("p",[s._v("https://docs.mongodb.com/manual/crud/")])]),s._v(" "),t("h3",{attrs:{id:"插入"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#插入"}},[s._v("#")]),s._v(" 插入")]),s._v(" "),t("ul",[t("li",[s._v("图例")])]),s._v(" "),t("p",[t("code",[s._v("users")]),s._v(' 为要插入的"表"')]),s._v(" "),t("p",[t("img",{attrs:{src:"https://testingcf.jsdelivr.net/gh/oddfar/static/img/MongoDB/mongo-x-usage-3.png",alt:"img"}})]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#向集合中添加一个文档")]),s._v("\ndb.inventory.insertOne"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"canvas"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(", tags: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cotton"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("35.5")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#向集合中添加多个文档")]),s._v("\ndb.inventory.insertMany"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"journal"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(", tags: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"blank"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"red"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mat"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("85")]),s._v(", tags: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gray"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("27.9")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("35.5")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mousepad"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(", tags: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gel"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"blue"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22.85")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("注：当我们向 "),t("code",[s._v("inventory")]),s._v(" 中插入 "),t("code",[s._v("document")]),s._v(" 文档时, 如果没有给文档指定 "),t("code",[s._v("_id")]),s._v(" 属性, 那么数据库会为文档自动添加 "),t("code",[s._v("_id")]),s._v(" field, 并且值类型是 "),t("code",[s._v("ObjectId(blablabla)")]),s._v(", 就是文档的唯一标识, 类似于 relational database 里的 "),t("code",[s._v("primary key")])]),s._v(" "),t("p",[s._v("这个数据库工具叫 "),t("strong",[s._v("Navicat")])]),s._v(" "),t("blockquote",[t("p",[s._v("“Navicat”是一套可创建多个连接的数据库管理工具，用以方便管理 MySQL、Oracle、PostgreSQL、SQLite、SQL Server、MariaDB 和/或 MongoDB 等不同类型的数据库，并支持管理某些云数据库，例如阿里云、‎腾讯云。")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://testingcf.jsdelivr.net/gh/oddfar/static/img/MongoDB/image-20210915173925342.png",alt:"image-20210915173925342"}})]),s._v(" "),t("blockquote",[t("ul",[t("li",[s._v("mongo 中的数字, 默认情况下是 double 类型, 如果要存整型, 必须使用函数 "),t("code",[s._v("NumberInt(整型数字)")]),s._v(", 否则取出来就有问题了")]),s._v(" "),t("li",[s._v("插入当前日期可以使用 "),t("code",[s._v("new Date()")])])])]),s._v(" "),t("p",[s._v("如果某条数据插入失败, 将会终止插入, 但已经插入成功的数据"),t("strong",[s._v("不会回滚掉")]),s._v(". 因为批量插入由于数据较多容易出现失败, 因此, 可以使用 "),t("code",[s._v("try catch")]),s._v(" 进行异常捕捉处理, 测试的时候可以不处理.如：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("try "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  db.comment.insertMany"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"articleid"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100001"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"content"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"我们不应该把清晨浪费在手机上, 健康很重要, 一杯温水幸福你我 他."')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"userid"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1002"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nickname"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"相忘于江湖"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"createdatetime"')]),s._v(":new Date"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2019-0805T22:08:15.522Z"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"likenum"')]),s._v(":NumberInt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"state"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"articleid"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100001"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"content"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"我夏天空腹喝凉开水, 冬天喝温开水"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"userid"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1005"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nickname"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"伊人憔 悴"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"createdatetime"')]),s._v(":new Date"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2019-08-05T23:58:51.485Z"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"likenum"')]),s._v(":NumberInt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("888")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"state"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"articleid"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100001"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"content"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"我一直喝凉开水, 冬天夏天都喝."')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"userid"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1004"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nickname"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"杰克船 长"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"createdatetime"')]),s._v(":new Date"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2019-08-06T01:05:06.321Z"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"likenum"')]),s._v(":NumberInt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("666")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"state"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"4"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"articleid"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100001"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"content"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"专家说不能空腹吃饭, 影响健康."')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"userid"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1003"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nickname"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"凯 撒"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"createdatetime"')]),s._v(":new Date"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2019-08-06T08:18:35.288Z"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"likenum"')]),s._v(":NumberInt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"state"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"articleid"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100001"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"content"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"研究表明, 刚烧开的水千万不能喝, 因为烫 嘴."')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"userid"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1003"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nickname"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"凯撒"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"createdatetime"')]),s._v(":new Date"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2019-0806T11:01:02.521Z"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"likenum"')]),s._v(":NumberInt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"state"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" catch "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  print "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("h3",{attrs:{id:"查询"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查询"}},[s._v("#")]),s._v(" 查询")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://testingcf.jsdelivr.net/gh/oddfar/static/img/MongoDB/mongo-x-usage-4.png",alt:"img"}})]),s._v(" "),t("ul",[t("li",[s._v("使用 "),t("code",[s._v("db.<collection_name>.find()")]),s._v(" 方法对集合进行查询, 接受一个 json 格式的查询条件. 返回的是一个"),t("strong",[s._v("数组")])]),s._v(" "),t("li",[t("code",[s._v("db.<collection_name>.findOne()")]),s._v(" 查询集合中符合条件的第一个文档, 返回的是一个"),t("strong",[s._v("对象")])])]),s._v(" "),t("p",[s._v("查询全部数据：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("db.inventory.find"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("数据准备：")])]),s._v(" "),t("p",[s._v("先删除之前的数据：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("db.comment.deleteMany"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("我们先往 comment 插入一些数据：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("db.comment.insertMany"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"journal"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"notebook"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.5")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"in"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"paper"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.5")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"in"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"D"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"planner"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22.85")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"D"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postcard"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("45")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15.25")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("ul",[t("li",[s._v("可以使用 "),t("code",[s._v("$in")]),s._v(" 操作符表示：查看状态是 A 和 D 的")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("db.comment.find"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" status: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$in")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"D"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("多个查询条件用逗号分隔, 表示 "),t("code",[s._v("AND")]),s._v(" 的关系")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('db.comment.find( { status: "A", qty: { $lt: 30 } } )\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("等价于sql : "),t("code",[s._v('SELECT * FROM comment WHERE status = "A" AND qty < 30')])]),s._v(" "),t("ul",[t("li",[s._v("使用 "),t("code",[s._v("$or")]),s._v(" 操作符表示后边数组中的条件是OR的关系")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("db.comment.find"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$or")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" status: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" qty: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$lt")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("等价于sql : "),t("code",[s._v('SELECT * FROM inventory WHERE status = "A" OR qty < 30')])]),s._v(" "),t("ul",[t("li",[s._v("可以使用 "),t("code",[s._v("pretty()")]),s._v(" 来帮助阅读")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("db.comment.find"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".pretty"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("创建索引")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("db.posts.createIndex"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" title "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'text'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n// 文本搜索\n// will "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" document with title "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Post One"')]),s._v("\n// "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" there is no "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" posts created\ndb.posts.find"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$text")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$search")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("Post O"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v('"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".pretty"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("h3",{attrs:{id:"更新"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更新"}},[s._v("#")]),s._v(" 更新")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://testingcf.jsdelivr.net/gh/oddfar/static/img/MongoDB/mongo-x-usage-5.png",alt:"img"}})]),s._v(" "),t("ul",[t("li",[s._v("使用 "),t("code",[s._v("db.<collection_name>.updateOne(<filter>, <update>, <options>)")]),s._v(" 方法修改一个匹配 "),t("code",[s._v("<filter>")]),s._v(" 条件的文档")]),s._v(" "),t("li",[s._v("使用 "),t("code",[s._v("db.<collection_name>.updateMany(<filter>, <update>, <options>)")]),s._v(" 方法修改所有匹配 "),t("code",[s._v("<filter>")]),s._v(" 条件的文档")]),s._v(" "),t("li",[s._v("使用 "),t("code",[s._v("db.<collection_name>.replaceOne(<filter>, <update>, <options>)")]),s._v(" 方法"),t("strong",[s._v("替换")]),s._v("一个匹配 "),t("code",[s._v("<filter>")]),s._v(" 条件的文档")]),s._v(" "),t("li",[t("code",[s._v("db.<collection_name>.update(查询对象, 新对象)")]),s._v(" 默认情况下会使用新对象替换旧对象")])]),s._v(" "),t("p",[s._v("其中 "),t("code",[s._v("<filter>")]),s._v(" 参数与查询方法中的条件参数用法一致.")]),s._v(" "),t("p",[s._v("如果需要修改指定的属性, 而不是替换需要用“修改操作符”来进行修改")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("$set")]),s._v(" 修改文档中的制定属性")])]),s._v(" "),t("p",[s._v("其中最常用的修改操作符即为"),t("code",[s._v("$set")]),s._v("和"),t("code",[s._v("$unset")]),s._v(",分别表示"),t("strong",[s._v("赋值")]),s._v("和"),t("strong",[s._v("取消赋值")]),s._v(".")]),s._v(" "),t("p",[s._v("先加入一些数据：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("db.inventory.insertMany"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"canvas"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("35.5")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"journal"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mat"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("85")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("27.9")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("35.5")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mousepad"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22.85")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"P"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"notebook"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.5")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"in"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"P"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"paper"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.5")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"in"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"D"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"planner"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22.85")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"D"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postcard"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("45")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15.25")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sketchbook"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sketch pad"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("95")]),s._v(", size: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" h: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22.85")]),s._v(", w: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30.5")]),s._v(", uom: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", status: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[s._v("更新数据：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("db.inventory.updateOne"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"paper"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$set")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"size.uom"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cm"')]),s._v(", status: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"P"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$currentDate")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" lastModified: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\ndb.inventory.updateMany"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" qty: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$lt")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$set")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"size.uom"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"in"')]),s._v(", status: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"P"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$currentDate")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" lastModified: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("p",[t("code",[s._v("db.<collection_name>.replaceOne()")]),s._v(" 方法替换除 "),t("code",[s._v("_id")]),s._v(" 属性外的"),t("strong",[s._v("所有属性")]),s._v(", 其"),t("code",[s._v("<update>")]),s._v("参数应为一个"),t("strong",[s._v("全新的文档")]),s._v(".")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("db.inventory.replaceOne"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"paper"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"paper"')]),s._v(", instock: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" warehouse: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" warehouse: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"B"')]),s._v(", qty: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("blockquote",[t("p",[s._v('修改前：\n{ item: "paper", qty: 100, size: { h: 8.5, w: 11, uom: "in" }, status: "D" }')]),s._v(" "),t("p",[s._v('修改完后：\n{  "item" : "paper", "instock" : [ { "warehouse" : "A", "qty" : 60 }, { "warehouse" : "B", "qty" : 40 } ] }')])]),s._v(" "),t("p",[t("strong",[s._v("批量修改")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("// 默认会修改第一条\ndb.document.update"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" userid: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"30"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("username: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"guest"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n// 修改所有符合条件的数据\ndb.document.update"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" userid: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"30"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("username: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"guest"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("multi: true"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"删除"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除"}},[s._v("#")]),s._v(" 删除")]),s._v(" "),t("ul",[t("li",[s._v("使用 "),t("code",[s._v("db.collection.deleteMany()")]),s._v(" 方法删除所有匹配的文档.")]),s._v(" "),t("li",[s._v("使用 "),t("code",[s._v("db.collection.deleteOne()")]),s._v(" 方法删除单个匹配的文档.")]),s._v(" "),t("li",[t("code",[s._v("db.collection.drop()")])]),s._v(" "),t("li",[t("code",[s._v("db.dropDatabase()")])])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("db.inventory.deleteMany"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" qty "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$lt")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("p",[s._v("Delete operations "),t("strong",[s._v("do not drop indexes")]),s._v(", even if deleting all documents from a collection.")]),s._v(" "),t("p",[s._v("一般数据库中的数据都不会真正意义上的删除, 会添加一个字段, 用来表示这个数据是否被删除")])]),s._v(" "),t("h2",{attrs:{id:"参考文章"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[s._v("#")]),s._v(" 参考文章")]),s._v(" "),t("ul",[t("li",[s._v("https://zhenye-na.github.io/2020/01/27/intro-to-mongodb.html")]),s._v(" "),t("li",[s._v("https://www.pdai.tech/md/db/nosql-mongo/mongo-x-usage-1.html")])])],1)}),[],!1,null,null,null);t.default=e.exports}}]);